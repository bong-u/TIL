---
title: "네트워크 보안"
date: 2024-06-05
---

## 네트워크 보안 개요

### 네트워크 보안의 요구사항
- 기밀성(Confidentiality)
    > 정보를 권한이 없는 개인에게 노출되지 않도록 함
- 무결성(Integrity)
    > 정보와 프로그램은 인가된 방식으로만 변경되도록 함
- 가용성(Availability)
    > 정보 자산에 대해 적절한 시간에 접근 가능하도록 함

### 보안 공격의 종류
1. 소극적 공격(Passive Attack)
    - 정보를 도청하거나 감시하는 공격
    - 방어방법 : 암호화
2. 적극적 공격(Active Attack)
    - 정보를 변조하거나 삭제하는 공격
    - 방어방법 : 메시지 인증

### 보안 서비스
1. 인증(Authentication)
    > 사용자의 신원을 확인하는 과정
    - 대등 개체 인증, 데이터-근원지 인증
2. 접근 제어(Access Control)
    > 자원을 불법적으로 사용하지 못하도록 방지하는 것
3. 데이터 기밀성(Data Confidentiality)
    > 데이터의 불법적 노출을 막는 것
    - 연결기밀성, 비연결 기밀성, 선별된-필드 기밀성, 트래픽-흐름 기밀성
4. 데이터 무결성(Data Integrity)
    > 수신된 데이터가 송신된 데이터와 일치하는지 확인하는 것
    - 연결형 데이터 무결성, 비연결형 데이터 무결성
    - 복구 가능한 데이터 무결성, 복구 불가능한 데이터 무결성
    - 선별된-필드 연결 무결성, 비연결 무결성, 선별된-필드 비연결 무결성
5. 부인 봉쇄 (Non-repudiation)
    > 통신의 한 주체가 통신에 참여했던 사실을 부인하는 것을 방지
6. 가용성 서비스 (Availability Service)
    > 서비스를 사용할 수 있는 상태를 유지하는 것


### 보안 메커니즘
#### 특정 보안 메커니즘
> 특정 프로토콜 계층에서 구현되는 메커니즘
- 인증
- 암호화
- 디지털 서명
- 접근 제어
- 데이터 무결성
- 인증 교환
- 트래픽 패딩
- 경로 제어
- 공증

#### 일반 보안 메커니즘
> 계층과 서비스에 독립적인 메커니즘
- 신뢰받는 기능
- 보안 레이블
- 사건 탐지
- 보안 감사 추적
- 보안 복구

## 암호 기술의 이해

### 전통적인 암호 기술
#### 암호를 사용하는 목적
- 비밀성 유지 (Confidentiality)
- 무결성 유지 (Data Integrity)
- 사용자 또는 자료의 출처 인증 (Authentication)
- 부인 방지 (Non-repudiation)

#### 암호 해독
> 해독자는 암호 시스템을 알고 있지만, 키만 모름
- Cipher Text Only Attack : 암호문 단독 공격
- Know Plain Text Attack : 알려진 평문 공격
- Chosen Plain Text Attack : 선택적 평문 공격

#### 공개키 암호화 비밀키 암호의 비교
| 구분 | 공개키 암호 | 비밀키 암호 |
|---|---|---|
| 키의 관계 | 암호화 키 != 복호화 키 | 암호화 키 = 복호화 키 |
| 키의 개수 | 2n | n(n-1)/2 |
| 1인당 필요한 비밀키 | 1 | n-1 |
| 속도 | 비효율적 | 효율적 |


#### 대칭키(비밀키) 암호
- 종류
    - 블록 암호 : 블록 단위로 암호화
        > DES, IDEA, AES
    - 스트림 암호 : 비트 단위로 암호화
        > RC4, A5/1
    - 한국에서 사용하는 알고리즘
        > NEAT, SEED, NES, ARIA

#### 공개키(비대칭키) 암호
- 종류
    - 소인수 분해 기반 : RSA
    - 이산 대수 기반 : ElGamal
    - 타원 곡선 기반
- 키 생성
    - 서로소인 두 소수 p, q를 선택
    - n = p * q
    - φ(n) = (p-1)(q-1)
    - gcd(e, φ(n)) = 1을 만족하는 e 선택
    - d * e mod φ(n) = 1을 만족하는 d 선택
    - 공개키 : {e, n}, 비밀키 : {d, n}
- 암호화
    > C = M^e mod n
- 복호화
    > M = C^d mod n
- DH (Diffie Hellman) 키 공유
    - q(소수), α(q의 원시근, α<q)
    - 임의 수 $X_A < q$를 만족하는 $X_A$를 선택
    - 공개할 $Y_A = \alpha^{X_A} mod\ q$
    - 상대방이 생성하는 비밀키 $K = Y_A^{X_B} mod\ q$

### 암호 기술의 활용
#### 디지털 서명
- 특성
    > 위조 불가, 변경 불가, 서명자 인증, 재사용 불가, 부인 방지
- 서명자의 비밀키로 암호화
- 서명자의 공개키로 복호화

#### 단방향 해시 함수를 이용한 메시지 인증
- 해시 함수의 요건
    - 단방향성 : H(x) = h일때, x를 찾는 것이 불가능해야한다
    - 약한 충돌 저항성 : H(x)=H(y)를 만족하는 y(=x)를 찾는 것이 불가능해야한다
    - 강한 충돌 저항성 : H(x)=H(y)를 만족하는 (x, y)를 찾는 것이 불가능해야한다

#### 공개키 기반 구조
- 인증서
    > 공개키와 사용자 정보를 포함한 전자 문서
    - 표준 : X.509 v3
- PKI (Public Key Infrastructure)
    > 공개키를 관리하고 인증하는 구조
    - CA (Certificate Authority) : 인증서 발급
    - RA (Registration Authority) : 사용자 등록
    - CRL (Certificate Revocation List) : 폐기된 인증서 목록

### 동형암호와 양자암호 기술
#### 동형암호
> 암호화된 상태에서 연산을 수행한 결과를 복호화하면 원문과 같은 결과를 얻는 암호화 기법
- 부분 동형 암호 : 덧셈과 곱셈 중에서 하나의 연산만 지원
- 준동형 암호 : 연산의 횟수에 제한이 존재
- 완전 동형 암호 : 임의의 계산을 수행 가능
- 활용
    - 암호화된 상태로 연산을 하기 때문에 보안성이 높음

#### 양자 내성 암호 (PQC: Post Quantum Cryptography)
> 양자 컴퓨터에 의한 공격으로부터 안전한 공개키 암호

- QKD(Quantum Key Distribution) : 양자 통신을 위해 비밀키를 분배/관리하는 기술
- QRNG(Quantum Random Number Generator) : 양자 난수 생성기

## 사용자 인증

### 사용자 인증 원리
- 인증 절차
    1. 신원 확인 단계
    2. 입증 단계
- NIST의 전자 인증 모델
- 인증 수단
    - 알고 있는 것을 통한 인증 : 비밀번호
    - 소유물을 통한 인증 : OTP 기기, 인증서
    - 생체 조직을 통한 인증 : 지문, 망막
    - 행동을 통한 인증 : 목소리 패턴, 필적
- 보존 등급 영향 프로파일
    - 보증레벨 : 신뢰서 정도에 따라 4가지 등급으로 분류

### 비밀번호 기반 인증
- 공격 유형
    - 오프라인 사전 공격
    - 특정 계정 공격
    - 잘 알려진 패스워드 공격, 대입 공격
    - 단일 사용자에 대한 패스워드 추측
    - 단말기 강탈
    - 사용자 실수 이용
    - 다중 비밀 번호 사용
    - 컴퓨터 모니터링 : 통신 패킷 분석
-  해시화된 비밀번호 사용
    - Salt의 역할
        > 비밀번호가 같아도 다른 해시값을 가지도록 함
- 패스워드 크랙킹
    - 사전 공격
    - 레인보우 테이블 공격 : 모든 솔트에 대한 해시 값을 계산해 놓은 테이블을 이용
- 패스워드 선택 기법
    - 사용자 교육
    - 컴퓨터 발생 패스워드
    - 패스워드 검사의 활성화 : 자체 패스워드 크래커 실행
    - 사전 패스워드 검사 : 패스워드 안정성 검사

### 토큰 기반 인증
#### 종류
- 메모리 카드 
- 스마트 카드 : 임베디드 마이크로프로세서 포함

### 생체 인증
- 기술 정확도 : 확률 밀도 함수로 표현하면 정규 분포를 따름
- FAR (False Acceptance Rate) : 거짓 수락률
- FRR (False Rejection Rate) : 거짓 거부율
- EER (Equal Error Rate) : FAR과 FRR이 같은 지점

### 원격 사용자 인증
- 멀티 팩터 인증 : 두 요소 이상을 사용한 인증
- 멀티 채널 인증 : 다양한 채널을 통해 인증

#### 인증 프로토콜
- 패스워드 프로토콜
    1. 호스트가 난수를 생성, 사용자에게 전송
    2. 사용자는 패스워드와 난수를 조합하여 해시값을 생성, 전송
- 토큰 프로토콜
    1. 호스트가 난수를 생성, 사용자에게 전송
    2. 사용자는 토큰을 사용하여 난수를 암호화, 전송
- 정적 생체 프로토콜
    1. 호스트는 난수와 암호화를 위한 식별자를 전송
    2. 사용자는 이를 사용하여 생체 정보를 암호화, 전송
- 동적 생체 프로토콜
    1. 호스트가 사용자에게 랜덤 시퀀스나 난수를 전송
    2. 사용자는 이를 말하거나, 글자를 쓰는 등의 동작을 수행, 암호화 후 전송

## 접근 제어

### 접근 제어 원리

#### 접근제어 철학
- 접근통제 영역
    - 관리적 통제
    - 기술적 통제
    - 물리적 통제
- 접근 제어 원칙
    - 알 필요성 원칙
    - 최소 권한 원칙
    - 최대 권한 원칙
    - 직무 분리 원칙

#### 접근 제어 기본 요소
- 주제 : 객체에 접근 가능한 존재 : user, group, other
- 객체 : 접근이 제어되는 자원 : 파일 또는 레코드
- 접근 권한 : 주체가 객체에 접근할 수 있는 방법 : 읽기, 쓰기, 실행 등

#### 접근 제어 요구 사항
- 닫힌 정책 : 화이트리스트 관리
- 열린 정책 : 블랙리스트 관리

#### 접근 제어 정책
- 임의 접근 제어 (DAC)
- 강제적 접근 제어 (MAC)
- 역할 기반 접근 제어 (RBAC)
- 속성 기반 접근 제어 (ABAC)

### 임의 접근 제어 (DAC, 자율적 접근 제어)
> 한 개체가 자신의 의지대로 다른 개체에게 권한을 부여하는 방식

#### 접근 제어 목록 (access control list)
    > 개체별로 접근 권한을 명시하는 방식

#### 인가 테이블

#### 확장된 접근 제어 매트릭스

#### UNIX 파일 접근 제어
- Set-UID : 실행할 때, euid를 소유자의 id로 설정됨
    - ex) -rwsr-xr-x : 4755 
- Set-GID : 실행할 때, egid를 소유그룹의 id로 설정됨
    - ex) -rwxr-sr-x : 2755
- 패스워드 파일 : /etc/shadow : ---------- : 000

### 역할 기반 접근 제어
> 사용자의 역할에 따라 접근 권한을 부여하는 방식

#### 역할 계층 - RBAC1
> 역할 구조는 기관 내 역할의 계층 구조를 나타내는 수단
#### 제약(전제조건)의 의미와 종류 - RBAC2
- 제약의 종류
    - 상호 배타적인 역할 : 직무와 능력을 분리
    - cardinality : 역할에 관한 최대숫자를 설정
    - 전제 조건 : 특정 역할이 다른 명시된 역할에 할당 되었다면, 사용자는 그 역할에만 할당될 수 있다

### 속성 기반 접근 제어
> 자원과 주체의 성질의 특성에 대한 조건을 표현하여 접근 권한을 정의하는 방식

- ABAC 모델의 3가지 주요 요소
    - 구성 내의 존재를 위해 정의된 속성
    - ABAC 정책을 위해 정의된 정책 모델
    - 접근 제어 실행을 위한 정책에 적용되는 구조 모델

#### 속성
> 주체, 객체 환경 조건, 권한에 의해 미리 정의되고 할당된 요구 동작의 특정 측면을 정의하는 성질
- 유형
    - 주체 속성 : 사용자, 응용 프로그램, 프로세스, 디바이스
    - 객체 속성 : 디바이스, 파일, 프로그램, 네트워크 등
    - 환경 속성 : 날짜, 시간, 네트워크 보안 레벨 등

#### ABAC의 논리 구조
- ACL 접근 체인
- ABAC 신뢰 체인

#### 정책
> 조직 내에서 주체의 권한과 환경 조건에서 자원 혹은 객체들이 보호되는 것에 기반한 허가된 행위를 관리하는 규칙과 관계의 집합

### 강제적 접근 제어 (MAC)
> 객체에 포함된 정보의 비밀성과 이러한 비밀성의 접근 정보에 대하여 주체가 갖는 권한에 근거하여 객체에 대한 접근을 제한하는 방법

#### 기밀성에 따른 접근 권한 제어
- No read up (단순 보안 속성)
    > 보안 수준이 낮은 주체는 보안 수준이 높은 객체를 읽을 수 없음
- No write down (*(스타) 보안 특성)
    > 보안 수준이 높은 주체는 보안 수준이 낮은 객체에 기록할 수 없음
#### 무결성에 따른 접근 권한 제어
- No read up (단순 무결성 특성)
    > 보안 수준이 높은 주체는 보안 수준이 낮은 객체를 읽을 수 없음
- No write down (*(스타) 무결성 특성)
    > 보안 수준이 낮은 주체는 보안 수준이 높은 객체에 기록할 수 없음

### 신원, 신용장, 접근 관리 (ICAM)

## 서비스 거부 공격

### 서비스 거부 공격
- 공격할 수 있는 자원 : 네트워크 대역폭, 시스템 자원, 응용 프로그램 자원
- 전통적인 DoS 공격
    - 플러딩 핑 명령
        > 대상 조직에 대해 네트워크 연결 기능을 제압하는 것이 목적
- 시작 주소 스푸핑
    - 위조된 소스 주소 사용
    - 후방 산란(backscatter) 트래픽을 이용해 대응
#### SYN 스푸핑
- 일반적인 DoS공격
- 연결을 관리하는 테이블을 넘치게 함
- Flooding 공격에 비해 적은 트래픽으로 공격 가능
- 공격자 입장
    - 스푸핑된 시스템이 존재한다면 Reset 패킷을 수신
    - 존재하지 않으면 타이머에 의한 재전송 후 엔트리 삭제
    - Reset으로 반응하지 않는 주소를 사용

### 플러딩 공격
- 프로토콜에 따라 분류
    - ICMP 플러딩
    - UDP 플러딩
    - TCP SYN 플러딩
#### DDoS (Distributed Denial of Service)
> 여러 대의 컴퓨터를 사용하여 대상 시스템을 공격하는 방식

### 분산 서비스 거부 공격
#### 세션 개시 프로토콜(SIP) 플러드
- 세션 개시 프로토콜 : VoIP 기술에 대한 표준 프로토콜

### 응용프로그램 기반 대역폭 공격
#### HTTP 기반 공격
- 스파이더링(spidering)
    > 특정 HTTP 링크에서 시작되며, 재귀적 방식으로 제공되는 웹사이트에 모든 링크를 따르는 봇
- R-U-DEAD-YET (RUDY) 공격
    > Content-Length를 크게 설정하여 서버의 지연을 유발하는 기법
- Slowloris 공격
    > 비정상적인 헤더 값을 서버로 요청하여 연결을 유지하여, 서버가 헤더를 기다리게 하는 공격

### 반사 및 증폭 공격
#### 반사 공격
- TCP SYN 스푸핑 공격
- DNS 반사 공격

#### 증폭 공격 (smurfs)
- DNS 증폭 공격
    - 공격자가 타겟 시스템의 스푸핑 소스 주소를 담고 있는 DNS 연쇄적 요청
    - 적은 요청으로 많은 트래픽을 발생시키는 DNS 행위를 이용
    - 방어책 : 스푸핑 소스 주소의 사용을 방지

### DoS 공격 방어, 예방, 대응
#### DoS 공격 예방
- 스푸핑 소스 주소 차단
- TCP 연결 관련 코드를 수정
- IP 다이렉트 브로드캐스팅 기능 차단
- 의심스러운 서비스나 부호조합 차단
- capcha를 이용해 자동화된 요청 차단
- 알맞은 표준 시스템 보안 관행화
- 미러 서버 또는 복제 서버의 사용

#### DoS 공격 대응
- 공격 유형 확인 : 패킷 캡처
- ISP로 패킷의 흐름을 역추적 : 높은 비용 발생
- 비상 사태 계획 구현
- 사고 대응 계획 업데이트

#### DNS 싱크홀 적용
> 좀비와 C&C 서버의 통신을 차단하는 방법

#### DDoS 대피소

## 침입 탐지와 침입 차단

### 침입자
- 침입자 유형
    - 사이버 범죄자
    - 해킹주의자
    - 정부 후원 집단
    - 기타
- 행동 패턴
    1. 공격 대상 포착 및 정보 수집
    2. 초기 접속
    3. 권한 상승
    4. 정보 수집 또는 시스템 공격
    5. 접근 관리
    6. 추적 회피

### 침입 탐지
- 보안 침입 : 침입자가 허가 권한 없이 시스템 (또는 자원)을 빼내거나 액세스하려는 시도로 구성된 사건의 조합
- 침입 탐지 : 허가되지 않은 방식으로 시스템 자원에서의 접근 시도를 발견 및 실시간으로 알려주는 목적의 시스템을 모니터링하고 분석하는 보안 서비스

#### 침입 탐지 시스템 (IDS)
- 호스트 기반 IDS
- 네트워크 기반 IDS
- 분산 IDS 또는 하이브리드 IDS

#### 분석 방법
- 이상 징후 탐지
    - 행동 기반 탐지 : 행동 패턴을 기반으로 탐지
    - 시그니처 탐지 : 알려진 공격 패턴을 기반으로 탐지
- 시그니처 방식 또는 휴리스틱 방식

#### 호스트 기반 IDS
- HIDS
> 취약하거나 민감한 시스템에 특수 보안 소프트웨어 계층을 추가
- 데이터 소스
    - 시스템 호출 추적
    - 로그 파일
        - 네이티브 감사 기록 : 시스템이 생성하는 로그 파일
        - 특정 감사 기록 : IDS에 의해 요구된 정보만을 기록하는 수집 시설
    - 파일 무결성 체크섬
    - 레지스트리 액세스
- USTAT 액션 vs SunOS 이벤트 유형
- 분산 호스트 기반 침입 탐지

#### 네트워크 기반 IDS
- NIDS
    > 네트워크 트래픽을 모니터링하여 침입을 탐지
- NIDS 센서 배치
    - 인라인 센서 : 네트워크 세그먼트에 삽입되어 그 센서를 통과하는 트래픽만 감지
    - 수동 센서 : 네트워크 트래픽 사본을 감시
- 침입 탐지 기법
    - 시그니처 탐지
    - 이상 징후 감지
- Stateful protocol analysis
    > 트래픽의 상태를 추적하여 비정상적인 트래픽을 탐지

### 방화벽
- 기능
    - 접근 통제
    - 사용자 인증
    - 감사 및 로그 기능
    - 주소 변환 기능 (NAT)
- 종류
    - 호스트 기반 방화벽 
    - 네트워크 기반 방화벽

### 통합 위협 관리 (UTM)
> 방화벽, IDS, IPS, 백신 등의 다양한 보안솔루션의 기능을 하나로 통합한 장비
- 편의성이 높고 비용을 절감할 수 있음

### 허니팟
> 공격자의 공격을 유도하여 공격자의 행동을 분석하는 시스템

### 스노트
> 호스트 또는 네트워크 기반의 오픈소스 IDS

- 패킷 디코더 : 프로토콜 헤더 식별 및 격리
- 탐지 엔진 : 규칙 집합을 기반으로 각 패킷을 분석
- 로거 : 규칙과 일치하는 각 패킷을 소형으로 저장
- 경고 : 탐지된 패킷에 대해 경고를 보냄

## SSL/TLS/VPN

### SSL의 기본 개념
#### SSL/TLS 프로토콜 구성
- Handshake Layer : Handshake, Cipher spec 변경, Alert 프로토콜로 구성
- Record Layer : 단편화, 압축, 무결성, 암호화 기능을 제공하는 Record 프로토콜로 구성
#### SSL/TLS Handshake
1. client->server
    - hello
2. server->client
    - hello
    - certificate : 서버 인증서
    - server key exchange : 서버 키 교환
    - certificate_request : 클라이언트 인증서 요청 (선택)
    - hello done
3. client->server
    - certificate : 클라이언트 인증서 (선택)
    - client key exchange : 클라이언트 키 교환
    - certificate_verify : 서버 인증서 검증 (선택)
    - change cipher spec
    - finished
4. server->client
    - change cipher spec
    - finished

#### Change Cipher Spec Protocol
> 상대방에게 새로운 암호화 방식을 사용하도록 알리기 위해 사용

#### Alert Protocol
> 오류 발생시 상대방에게 오류를 통보하기 위해 사용
- 경고와 심각으로 분류, 심각의 경우 연결 종료

#### Record Protocol
- 동작과정 : 단편화 -> 압축(선택) -> MAC 첨부 -> 암호화 -> SSL 레코드 헤더 붙이기
- MAC : 키 공유과정에서 도출된 비밀키 사용
- 암호화 : 압축된 메시지와 MAC을 대칭 암호로 암호화

### SSL vs TLS
- Handshake에서의 차이점
    - TLS로 발전하면서 Handshake 프로세스를 줄임
    - 사용하는 총 암호 그룹 수를 줄여 프로세스 속도를 향상
- Alert에서의 차이점
    - 알림 메시지 유형이 추가됨
    - TLS Alert는 보안을 위해 암호화되어 전송됨
- 메시지 인증에서의 차이점
    - SSL은 MAC을 사용, TLS는 HMAC을 사용
- Cipher suite에서의 차이점
    - 취약한 알고리즘(RC4, DES) 사용 중단
    - 신규 키 교환, 검증, 암호화, MAC 알고리즘 적용
    - TLS는 버전 별로 지원하는 Cipher suite가 다름

### SSL/TLS 활용
#### TLS 서버 구축 방법
1. 키쌍 생성
2. 생성한 공개키를 넣어서 CSR 생성, 개인키로 전자 서명
3. CSR을 인증서 발급기관에 전송
4. 인증서 발급기관은 CSR의 전자 서명을 CSR에 포함된 공개키로 서명 검증
5. 사용자의 공개키와 추가정보(도메인, 이메일 등)를 추가하여 SSL 인증서 발급
6. 웹서버에 적용

#### SSL/TLS 서버의 보안 강화
- HSTS (HTTP Strict Transport Security)
    > HTTPS로만 통신하도록 강제하는 기술
    - 헤더에 `Strict-Transport-Security`를 설정
    - max-age 기간동안 자동 적용

### SSL/TLS 취약점
- TLSv1.2이전의 프로토콜은 취약점이 존재

#### POODLE (Padding Oracle On Downgraded Legacy Encryption)
> 블록 암호화 기법인 CBC 모드 사용시 암호문이 MAC에 의해 보호되지 않는 취약점

#### DROWN (Decrypting RSA with Obsolete and Weakened eNcryption)
> 공격자가 SSLv2 proves를 송신하여 키를 찾아낼 수 있는 취약점

#### BEAST (Browser Exploit Against SSL/TLS)
> CBC의 취약점을 이용해 HTTPS 쿠키를 해독할 수 있는 취약점

#### FREAK (Factoring RSA Export Keys)
> SSL 서버가 공격에 의해 수출용 RSA를 허용하도록 다운그레이드 시킨후 Brute-force로 키를 찾아내는 취약점

#### Logjam
> SSL 서버가 공격에 의해 수출용 DHE를 허용하도록 다운그레이드 시킨후 Brute-force로 키를 찾아내는 취약점

#### Heartbleed
> OpenSSL 1.0.1의 메모리 누수 취약점

#### 취약점 대응
- 서버 관리자 : 취약한 프로토콜, Cipher suite를 사용하지 않도록 설정, 철저한 비밀키 관리
- 클라이언트 사용자 : 최신 버전의 브라우저 유지, 서버의 인증서 확인, 안전하지 않은 사이트 방문 자제
- 공통 : 최신 SLS/TLS 프로토콜 소프트웨어 사용

### HTTPS 패킷 차단 기술 및 이슈

#### DNS 서버 응답 변조 및 IP 차단
> DNS 서버의 응답을 변조하여 HTTPS 접속을 차단하는 기술
- CDN 서버 경유를 통해 우회하는 사례가 등장 -> 패킷 분석 기반 차단

#### 패킷 분석 기반 차단
> 패킷을 분석하여 HTTPS 패킷을 차단하는 기술
- DPI (Deep Packet Inspection) : 패킷의 헤더와 페이로드를 분석하여 차단

#### HTTPS SNI 기반 차단
- TLS 통신 표준을 역이용한 차단 방법
- SNI는 Client Hello 단계에서 평문으로 전송된다는 특성을 활용하여 차단

### TLS 악용과 대응 기술

#### 악용사례
- 정보 유출 경로로의 악용
    > SSL/TLS 기술을 역이용하여 내부 정보 유출 시 내용을 알 수 없도록 함
- 악성 코드 유입 통로로의 악용
    > SSL/TLS 기술을 이용하여 악성 코드를 유포하는 통로로 사용

#### 대응 기술
- TLS 가시성 확보 기술
    > SSL/TLS을 복호화 해 가시성을 확보하는 기술
- TLS Fingering 기술
    > TLS Handshake 및 트래픽에서 특징을 추출하여 클라이언트 및 서버를 식별하는 기술
    - 메시지를 채취 -> 필드 추출 -> 지문 데이터 생성 -> 저장 및 비교
    - 기법 사용 예시 : JA3, 인공지능 기반 기술

## IPSec
> IP 패킷을 보호하기 위한 프로토콜

#### IPSec 개요
- 제공 : 인증, 기밀성, 키 관리
- 두 가지 모드
    - 전송 모드 : 페이로드만 암호화
    - 터널 모드 : 헤더와 페이로드 모두 암호화

### 프로토콜
#### AH(Authentication Header)
- 제공 : 인증, 무결성
### ESP(Encapsulating Security Payload)
- 제공 : 인증, 기밀성, 무결성
- ESP 단독 사용 또는 ESP+AH 사용(터널모드)

#### IKE (Internet Key Exchange)

<!doctype html><html>
<head>
<title> Bong-u's TIL </title>
<meta charset=utf-8>
<meta property="og:title" content="Bong-u's til">
<meta property="og:type" content="blog">
<meta property="og:url" content="https://github.com/bong-u/til-hugo">
<meta property="og:image" content="https://bong-u.github.io/til/asset/profile.jpg">
<script type=text/javascript src=https://bong-u.github.io/til/src/script.js></script>
<link rel=icon href=https://bong-u.github.io/til/favicon16.png sizes=16x16>
<link rel=icon href=https://bong-u.github.io/til/favicon32.png sizes=32x32>
<link id=twCSS rel=stylesheet href=https://bong-u.github.io/til/src/style.css>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$']], displayMath: [['$$','$$']]},
  });
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HE9FQR1ML7"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-HE9FQR1ML7')</script>
</head>
<body class="flex justify-center my-16">
<header class="absolute top-0 right-0 p-4 z-10 flex items-center gap-3 text-3xl">
<a href=https://bong-u.github.io/til/>🏠</a>
<a href=https://github.com/bong-u/til>🐈</a>
<input type=checkbox id=toggleDarkMode onchange=toggleDarkModeHandler() hidden>
<label class=cursor-pointer for=toggleDarkMode>
<span id=toggleButton>☀️</span>
</label>
</header>
<script>let anchorsCache=null;document.addEventListener("DOMContentLoaded",()=>{window.addEventListener("scroll",()=>{const c=document.getElementById("TableOfContents"),b=document.querySelectorAll("#TableOfContents a"),a=getCurrentAnchor();let d=0;for(let c=0;c<b.length;c++)b[c].classList.remove("current"),b[c]===a&&(d=c);a&&a.classList.add("current"),c.scroll(0,a.offsetTop-c.offsetHeight/2)})});const getTocItem=a=>document.querySelector('[href="'+a+'"]'),getCurrentAnchor=()=>{const c=window.pageYOffset,a=getAnchors();let b=null;for(let d=0;d<a.length;d++){const e=getHeading(a[d]).getBoundingClientRect().top+c;if(e<c+window.innerHeight*.23)b=a[d];else break}return b||(b=a[0]),getTocItem(b)},getAnchors=()=>(anchorsCache||(anchorsCache=Array.from(document.querySelectorAll("#TableOfContents a")).map(a=>a.getAttribute("href"))),anchorsCache),getHeading=a=>document.getElementById(a.substr(1))</script>
<aside class="fixed top-0 right-0 py-16 w-2/12 gap-3 mx-9 hidden lg:flex text-sm overflow-hidden">
<nav id=TableOfContents>
<ul>
<li><a href=#모니터링-시스템-구축-실습-elk>모니터링 시스템 구축 실습 (ELK)</a>
<ul>
<li><a href=#elk란>ELK란</a></li>
<li><a href=#kibana>Kibana</a></li>
<li><a href=#logstash>Logstash</a></li>
<li><a href=#docker-compose>Docker Compose</a></li>
<li><a href=#docker-compose-alias-설정>Docker Compose alias 설정</a></li>
<li><a href=#docker-compose-파일>Docker-Compose 파일</a></li>
<li><a href=#elk-실습>ELK 실습</a></li>
<li><a href=#참고--poc-proof-of-concept>참고 : PoC (Proof of Concept)</a></li>
</ul>
</li>
<li><a href=#kubernetes-이해하기>Kubernetes 이해하기</a>
<ul>
<li><a href=#kubernetes가-필요한-이유>Kubernetes가 필요한 이유</a></li>
<li><a href=#마이크로서비스-배포-단점>마이크로서비스 배포 단점</a></li>
<li><a href=#kubernetes-개념>Kubernetes 개념</a></li>
<li><a href=#컨테이너를-쓰는-이유>컨테이너를 쓰는 이유</a></li>
<li><a href=#kubernetes-아키텍처>Kubernetes 아키텍처</a></li>
<li><a href=#kubernetes-실습-1>kubernetes 실습 1</a></li>
<li><a href=#kubernetes-pod-소개>kubernetes pod 소개</a></li>
<li><a href=#kubernetes-백그라운드-동작>kubernetes 백그라운드 동작</a></li>
<li><a href=#kubernetes-워크로드-용어>kubernetes 워크로드 용어</a></li>
</ul>
</li>
</ul>
</nav>
<div onclick=scrollToTop() class="fixed p-5 right-0 bottom-0 text-center text-2xl cursor-pointer hover-bold">
🛆
</div>
</aside>
<main class="flex w-full justify-center">
<section class="px-4 w-11/12 lg:w-1/2 xl:w-7/12">
<div class=mb-10>
<div class="flex justify-between items-baseline my-4 whitespace-nowrap gap-8">
<h1 id=title class="overflow-hidden overflow-ellipsis text-3xl font-bold p-1">쿠버네티스 및 MSA 특강 3일차 : 모니터링 시스템 구축 실습 (ELK), kubernetes</h1>
<div class="flex flex-col items-end">
<h4 id=date> CREATED 2023-02-22 </h4>
<h4 id=date> MODIFIED 2023-02-22</h4>
</div>
</div>
</div>
<article id=content class="bg-inherit markdown-body flex flex-col">
<h2 id=모니터링-시스템-구축-실습-elk>모니터링 시스템 구축 실습 (ELK)</h2>
<h3 id=elk란>ELK란</h3>
<blockquote>
<p>ELK는 <strong>E</strong>lasticsearch, <strong>L</strong>ogstash 및 <strong>K</strong>ibana : 오픈 소스 프로젝트 세 개의 머리글</p>
</blockquote>
<ul>
<li>Elasticserach는 검색 및 분석 엔진</li>
<li>Logstash는 여러 소스에서 동시에 데이터를 수집하여 변환한 후 Elasticsearch 같은 &ldquo;stash"로 전송하는 서버 사이드 데이터 처리 파이프라인</li>
<li>Kibana는 사용자가 Elasticsearch에서 차트와 그래프를 이용해 데이터를 시각화</li>
</ul>
<h3 id=kibana>Kibana</h3>
<blockquote>
<p>Elasticsearch에 있는 데이터를 시각화할 수 있도록 하는 웹 브라우저 기반의 시각화 플랫폼</p>
</blockquote>
<ul>
<li>Elasticsearch에 있는 인덱스의 패턴을 찾아서, 데이터를 확인하거나, 시각화할 수 있도록 한다</li>
</ul>
<h3 id=logstash>Logstash</h3>
<blockquote>
<p>서버 데이터를 수집, 변환, 전송하는 데이터 처리 파이프라인으로, Jruby(JVM 기반 Ruby)로 개발되었다</p>
</blockquote>
<ul>
<li>데이터 처리 과정은 input, filter, out의 세 단계로 구성된다</li>
<li></li>
</ul>
<h3 id=docker-compose>Docker Compose</h3>
<h3 id=docker-compose-alias-설정>Docker Compose alias 설정</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>alias dco<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;docker-compose&#34;</span>
...
</code></pre></div><h3 id=docker-compose-파일>Docker-Compose 파일</h3>
<ul>
<li>docker-compose.yml</li>
<li>version:&lsquo;3.2&rsquo; // docker-compose file format / 각 버전 별로 제공 api가 다르다</li>
<li>services: // container 서비스 그룹</li>
<li>ports: // 포트 지정 Host Port : Container Port</li>
<li>depends_on: // 서비스간 의존관계 설정</li>
</ul>
<h3 id=elk-실습>ELK 실습</h3>
<ul>
<li>docker-compose 컨테이너 생성 및 실행</li>
</ul>
<pre tabindex=0><code>docker-compose up
</code></pre><ul>
<li>docker-compose 컨테이너 정지 및 삭제</li>
</ul>
<pre tabindex=0><code>docker-compose down
</code></pre><ul>
<li>docker-compose 컨테이너 목록 조회</li>
</ul>
<pre tabindex=0><code>docker-compose ps
</code></pre><ul>
<li>docker-compose 컨테이너 로그 조회</li>
</ul>
<pre tabindex=0><code>docker-compose logs
</code></pre><ul>
<li>ElasticSearch 확인</li>
</ul>
<pre tabindex=0><code>open http://localhost:9200/_cat/indices
</code></pre><ul>
<li>Kibana 확인</li>
</ul>
<pre tabindex=0><code>http://localhost:5601/app/kibana
</code></pre><ul>
<li>container 접속</li>
</ul>
<pre tabindex=0><code>docker-compose exec logstash sh
</code></pre><h3 id=참고--poc-proof-of-concept>참고 : PoC (Proof of Concept)</h3>
<blockquote>
<p>새로운 프로젝트가 실제로 실현 가능성이 있는가, 효과와 효용, 기술적인 관점에서부터 검증을 하는 과정</p>
</blockquote>
<h2 id=kubernetes-이해하기>Kubernetes 이해하기</h2>
<h3 id=kubernetes가-필요한-이유>Kubernetes가 필요한 이유</h3>
<ul>
<li>
<p>대부분의 어플리케이션 : 하나의 프로세스 또는 몇개의 서버에 분산된 프로세스로 실행되는 거대한 모놀리스</p>
<ul>
<li>이러한 시스템은 릴리즈 주기가 느리고 업데이트가 자주 일어나지 않음</li>
<li>개발자는 전체 릴리즈 주기가 끝날때 마다 전체 시스템을 패키징하고 운영팀은 이를 배포하고 모니터링한다</li>
<li>운영팀은 하드웨어 장애가 발생하면 이를 사용 가능한 서버로 직접 마이그레이션 한다</li>
</ul>
</li>
<li>
<p>거대한 모놀리스 레거시 애플리케이션은 점점 MSA로 더 작은 구성 요소로 세분화</p>
<ul>
<li>마이크로 서비스는 서로 분리돼 있기 때문에 개별적으로 개발, 배포, 업데이트, 확장 가능</li>
<li>배포 가능한 구성요소가 많아지고 데이터센터 규모가 커지면서 전체 시스템을 구성, 관리, 유지하기는 쉽지 않은 일</li>
<li>리소스 활용을 높이고 하드웨어 비용을 낮추고 각 구성요소를 배치할 위치를 파악하기에 너무 어려움</li>
<li>수동으로 불가능</li>
<li>이런 구성요소를 자동으로 스케쥴링하고 구성, 관리, 장애처리를 포함하는 자동화가 필요</li>
</ul>
</li>
<li>
<p>=> <strong>쿠버네티스가 필요한 이유</strong></p>
</li>
</ul>
<h3 id=마이크로서비스-배포-단점>마이크로서비스 배포 단점</h3>
<ul>
<li>각 구성 요소가 많아지면 배포 조합의 수 뿐만 아니라 구성 요소간의 상호 종속성 수가 훨씬 많아지므로 배포 관련 결정이 어렵다</li>
<li>여러 프로세스와 시스템에 분산돼 있기 때문에 실행 호출을 디버깅하고 추적하기 어렵다</li>
</ul>
<h3 id=kubernetes-개념>Kubernetes 개념</h3>
<ul>
<li>구글은 Borg라는 시스템을 개발해 애플리케이션 개발자와 시스템 관리자가 수천 개 어플리케이션과 서비스를 관리하는데 도움을 준다</li>
<li>구글 10년간 경험을 바탕으로 2014년에 kubernetes 프로젝트를 오픈소스화 한다</li>
<li>별명은 k8s이다</li>
</ul>
<h3 id=컨테이너를-쓰는-이유>컨테이너를 쓰는 이유</h3>
<ul>
<li>경량, 이식성 및 플랫폼 독립성, 최신형 개발 및 아키텍처 지원, 활용도 향</li>
</ul>
<h3 id=kubernetes-아키텍처>Kubernetes 아키텍처</h3>
<ul>
<li>마스터 노드 : 전체 쿠버네티스 시스템을 제어하고 관리하는 쿠버네티스 컨트롤 플레인을 실행</li>
<li>워커 노드 : 실제 배포되는 컨테이너 애플리케이션을 실행</li>
</ul>
<h3 id=kubernetes-실습-1>kubernetes 실습 1</h3>
<pre tabindex=0><code>minikube start
kubectl run ntest --image=develo0100/node --port 8080
curl localhost:8080
</code></pre><h3 id=kubernetes-pod-소개>kubernetes pod 소개</h3>
<ul>
<li>쿠버네티스는 개별 컨테이너들을 직접 다루지 않고, 함께 배치된 다수의 컨테이너라는 개념을 사용한다</li>
<li></li>
</ul>
<h3 id=kubernetes-백그라운드-동작>kubernetes 백그라운드 동작</h3>
<ol>
<li>도커 데몬이 실행 중인 다른 워커 노드에서 컨테이너 이미지로 접근하려면 도커허브에 이미지가 올려져있어야 한다</li>
<li>kubectl 명령어를 실행하면 쿠버네티스 API 서버로</li>
</ol>
<h3 id=kubernetes-워크로드-용어>kubernetes 워크로드 용어</h3>
<ul>
<li>Daemon set</li>
<li>Deployment</li>
<li>Job</li>
<li>Pod</li>
<li>Replica set</li>
<li>Replication controller</li>
</ul>
</article>
<div id=meta class=mt-24>
<div>
<div class="flex justify-between w-full whitespace-nowrap hover-bold">
<a class="previous mr-5 overflow-hidden overflow-ellipsis" href=/til/kubernetes/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EB%B0%8F-msa-%ED%8A%B9%EA%B0%95-2%EC%9D%BC%EC%B0%A8/>
쿠버네티스 및 MSA 특강 2일차 : Docker 실습</a>
<a class="next ml-5 overflow-hidden overflow-ellipsis" href=/til/kubernetes/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EB%B0%8F-msa-%ED%8A%B9%EA%B0%95-4%EC%9D%BC%EC%B0%A8/> 쿠버네티스 및 MSA 특강 4일차 : MSA란 무엇인가</a>
</div>
</div>
</div>
</section>
</main>
</body>
</html>